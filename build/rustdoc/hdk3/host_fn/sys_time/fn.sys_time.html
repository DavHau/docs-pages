<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `sys_time` fn in crate `hdk3`."><meta name="keywords" content="rust, rustlang, rust-lang, sys_time"><title>hdk3::host_fn::sys_time::sys_time - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled ><script src="../../../storage.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc fn"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../../hdk3/index.html'><div class='logo-container rust-logo'><img src='../../../rust-logo.png' alt='logo'></div></a><div class="sidebar-elems"><p class='location'><a href='../../index.html'>hdk3</a>::<wbr><a href='../index.html'>host_fn</a>::<wbr><a href='index.html'>sys_time</a></p><script>window.sidebarCurrent = {name: 'sys_time', ty: 'fn', relpath: ''};</script><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><span class="help-button">?</span>
                <a id="settings-menu" href="../../../settings.html"><img src="../../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../../../src/hdk3/host_fn/sys_time.rs.html#64-66' title='goto source code'>[src]</a></span><span class='in-band'>Function <a href='../../index.html'>hdk3</a>::<wbr><a href='../index.html'>host_fn</a>::<wbr><a href='index.html'>sys_time</a>::<wbr><a class="fn" href=''>sys_time</a></span></h1><pre class='rust fn'>pub fn sys_time() -&gt; <a class="type" href="../../../hdk3/map_extern/type.ExternResult.html" title="type hdk3::map_extern::ExternResult">ExternResult</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/core/time/struct.Duration.html" title="struct core::time::Duration">Duration</a>&gt;</pre><div class='docblock'><p>Trivial wrapper to return the current system time from the host.</p>
<p>System time doesn't accept any arguments so usage is as simple as:</p>

<div class='information'><div class='tooltip ignore'>ⓘ<span class='tooltiptext'>This example is not tested</span></div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore">
<span class="kw">let</span> <span class="ident">now</span> <span class="op">=</span> <span class="ident">sys_time</span>()<span class="question-mark">?</span>;</pre></div>
<p>Note: sys_time returns a result like all host fns so <code>?</code> or <code>.ok()</code> is needed.</p>
<p>System times can be considered &quot;secure&quot; or &quot;insecure&quot; situationally, some things to consider:</p>
<ul>
<li>the host signing times into chain headers is using the same clock in the host_fn call so the
the sys_time returned by a function for inclusion in an entry will always be less than or
equal to the time in the header of that entry unless:
<ul>
<li>the user manually changed the system time backwards between this host_fn being called and
an entry using it being committed (NTP avoids making time go backward by stretching it)</li>
<li>the sys_time call ran on a different machine, e.g. via a call_remote, to the machine that
commits it into an entry
so your app can decide to implement validation logic that fails any sys time that comes after
the time signed in the header if that makes sense.</li>
</ul>
</li>
<li>the times in the headers of the local source chain must increase monotonically and all
headers are pushed to the neighbourhood of the agent publishing them, so the agent activity
authorities will immediately warrant any headers running chronologically backwards</li>
<li>the times within a single element may be relatively secure but are easy to manipulate in an
absolute sense, the user can simply change their system clock before attempting a commit to
any time that is equal to or later than their current chain head</li>
</ul>
<p>This is an improvement on pushing time collection back onto the &quot;client&quot; which can't
guarantee that it is seeing the same time as the rust host, so this enables stricter validation
logic.</p>
<p>@todo
Sys times aren't the final word on secure times, for another option it may be best to use the
roughtime protocol which redundantly fetches cryptographically signed times from multiple
different servers and cross-references them.
There is a POC for this but it's not in core yet (requires at least UDP calls from the host).
Note that the <strong>redundant fetching</strong> and <strong>cross-referencing</strong> parts are critical, even though
they add a lot of complexity to the protocol. Failure to do this brought down the ETH2.0
Medalla testnet due to a single roughtime server from cloudflare being 24 hours off.
Note also that roughtime, or any other &quot;secure timestamping&quot; option requires the agent to be
online at the time of generating times, which runs counter to the requirement that holochain
support &quot;agent centric, offline first&quot; behaviour, but may be acceptable or even a neccessary
evil for specific application logic.
The other challenge with roughtime is list management to track the list of valid servers over
time, which might rely on agents providing snapshots of links to public keys (i.e. representing
the roughtime ecosystem itself in a happ).</p>
<p>@see https://blog.cloudflare.com/roughtime/</p>
<p>@todo
Another option is to use proof of work style constructions to roughly throttle the speed that
things can be done without relying on absolute times, or even that users experience the same
throttling due to differences in CPU/GPU performance on the POW algorithm.
@see https://zkga.me/ uses this as a game mechanic</p>
<p>@todo
Other p2p type time syncing algorithms that allow peers to adjust their clock offsets to agree
on the current time within relatively tight accuracy/precision up-front in a relatively trusted
environment e.g. a chess game between friends with time moves that balances security/trust and
flaky networking, etc.</p>
</div></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../../../";window.currentCrate = "hdk3";</script><script src="../../../main.js"></script><script defer src="../../../search-index.js"></script></body></html>